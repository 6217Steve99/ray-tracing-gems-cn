
GPU编程有三个独立于API的关键组件:(1)GPU设备代码，(2)CPU主机端设置过程，(3)主机与设备之间的数据共享。在讨论这些组件之前，第3.3节将介绍一些重要的软件和硬件需求，以便开始构建和运行基于DXR的程序。

然后，我们将讨论每个核心组件，从第3.4、3.5和3.6节中如何编码DXR着色器开始。用于DXR的高级着色器语言(HLSL)代码看起来类似于用c++编写的串行CPU射线跟踪器。利用函数库抽象主机端图形API(例如Falcor[2])，即使是初学者也可以快速构建有趣的gpu加速光线跟踪器。图3-1显示了一个例子，它是使用扩展的Falcor呈现的一个简单的路径追踪器。
![figure3-1](./figure3-1.png)
***
<p align="center">图3-1 基于DirectX 路径追踪呈现的Amazon Lumberyard小酒馆</p>

第3.7节概述了DXR主机端设置过程，并描述了驱动新API的思维模型。第3.8节详细介绍了初始化DXR、构建所需的光线加速结构和编译光线跟踪着色器所需的主机端步骤。第3.9节和第3.10节分别介绍了新的光线跟踪管道状态对象和着色器表，定义了主机和GPU之间的数据共享。最后，第3.11节展示了如何配置和启动光线。

DirectX抽象了光线加速结构，不像在软件渲染器中，选择这种结构是影响性能的关键选择。目前的共识是，包围卷层次结构(BVHs)比其他数据结构具有更好的特性，因此本章的前半部分将加速结构称为包围卷层次结构，尽管DirectX并不强制使用BVHs。第3.8.1节详细介绍了初始化加速度结构。